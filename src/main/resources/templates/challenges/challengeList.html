<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head"/>

<body>
<nav th:replace="fragments/header-nav :: header-nav"></nav>

<section class="container py-5">
  <div class="row justify-content-center my-5">
    <div class="filter-btns shadow-md rounded-pill text-center col-auto">
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="all" href="/challenges">전체</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="language" href="/challenges?category=language">프로그래밍 언어</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="frontend" href="/challenges?category=frontend">프론트엔드</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="backend" href="/challenges?category=backend">백엔드</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="app" href="/challenges?category=app">모바일 앱 개발</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="database" href="/challenges?category=database">데이터베이스</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="algorithm" href="/challenges?category=algorithm">알고리즘/자료구조</a>
      <a class="filter-btn btn rounded-pill btn-outline-primary border-0 m-md-2 px-md-4" id="etc" href="/challenges?category=etc">기타</a>
    </div>
  </div>

  <div class="row projects gx-lg-5">
    <a href="work-single.html" th:each="challenge : ${challengeList}" class="col-sm-6 col-lg-4 text-decoration-none project marketing social business">
      <div class="service-work overflow-hidden card mx-5 mx-sm-0 mb-5">
        <img class="card-img-top" th:src="${challenge.thumbnailFilePath}" style=" object-fit: none;">
        <div class="card-body">
          <h5 class="card-title light-300 text-dark" th:text="${challenge.title}"></h5>
          <p class="card-text light-300 text-dark">
          </p>
          <span class="text-decoration-none text-primary light-300">
            Read more <i class='bx bxs-hand-right ms-1'></i>
          </span>
        </div>
      </div>
    </a>
  </div>

  <!--페이징 번호-->
  <div class="row" th:if="${challengeList.totalElements} != 0">
    <div th:with="start=${T(Math).floor(challengeList.number / 5) * 5 + 1},
                    last=(${start + 4 < challengeList.totalPages ? start + 4 : challengeList.totalPages})" class="btn-toolbar justify-content-center pb-4" role="toolbar" aria-label="Toolbar with button groups">
        <div class="btn-group me-2" role="group" aria-label="First group">
          <button th:onclick="${challengeList.first} ? '#' : 'location.href=\'' + @{/challenges(page=${challengeList.number})}+'\''"
                  th:disabled="${challengeList.first}" type="button" class="btn btn-secondary text-white">◀</button>
        </div>
        <div class="btn-group me-2" role="group" aria-label="Second group" th:each="page: ${#numbers.sequence(start, last)}">
          <button type="button" class="btn btn-light" th:class="${page == challengeList.number + 1} ? 'btn btn-secondary text-white' : 'btn btn-light'"
                  th:text="${page}" th:onclick="'location.href=\'' + @{/challenges(page=${page})} + '\''"></button>
        </div>
        <div class="btn-group" role="group" aria-label="Third group">
          <button th:onclick="${challengeList.last} ? '#' : 'location.href=\'' + @{/challenges(page=${challengeList.number + 2})}+ '\''"
                  th:disabled="${challengeList.last} ? 'disabled'" type="button" class="btn btn-secondary text-white">▶</button>
        </div>
    </div>
  </div>
</section>

<footer th:replace="fragments/footer :: footer"></footer>

<script>
        $(window).load(function() {
            let category = new URLSearchParams(location.search).get('category');
            $(".filter-btn").removeClass("active");
            $(".filter-btn").removeClass("shadow");
            if(category == null) {
              $('#all').addClass("active");
              $('#all').addClass("shadow");
            } else {
              $('#' + category).addClass("active");
              $('#' + category).addClass("shadow");
            }
        });
</script>
</body>

</html>